### Variables
@baseUrl = http://localhost:3000/api

### ===== AUTH (zuerst einloggen um Token zu bekommen) =====

### Register (einmalig)
# @name register
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "Test1234!",
  "name": "Test User"
}

### Login (Token wird automatisch gespeichert)
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "Test1234!"
}

### Token aus Login-Response extrahieren
@authToken = {{login.response.body.accessToken}}

### ===== GROUPS =====

### Neue Gruppe erstellen
# @name createGroup
POST {{baseUrl}}/groups
Content-Type: application/json
Authorization: Bearer {{authToken}}

{
  "name": "Meine WG"
}

### Gruppe ID aus createGroup speichern
@groupId = {{createGroup.response.body.data.id}}
@inviteCode = {{createGroup.response.body.data.inviteCode}}

### Alle meine Gruppen abrufen
GET {{baseUrl}}/groups
Authorization: Bearer {{authToken}}

### Gruppe per ID abrufen
GET {{baseUrl}}/groups/{{groupId}}
Authorization: Bearer {{authToken}}

### Gruppe aktualisieren
PATCH {{baseUrl}}/groups/{{groupId}}
Content-Type: application/json
Authorization: Bearer {{authToken}}

{
  "name": "Neue WG Name"
}

### Gruppe per Invite-Code beitreten (anderer User)
POST {{baseUrl}}/groups/join
Content-Type: application/json
Authorization: Bearer {{authToken}}

{
  "inviteCode": "{{inviteCode}}"
}

### Gruppe verlassen
POST {{baseUrl}}/groups/{{groupId}}/leave
Authorization: Bearer {{authToken}}

### Invite-Code neu generieren
# @name regenerateInvite
POST {{baseUrl}}/groups/{{groupId}}/regenerate-invite
Authorization: Bearer {{authToken}}

### Neuer Invite-Code
@newInviteCode = {{regenerateInvite.response.body.data.inviteCode}}

### Mitglied Rolle ändern (memberId = UserId des Mitglieds)
@memberId = MEMBER_USER_ID_HERE
PATCH {{baseUrl}}/groups/{{groupId}}/members/{{memberId}}
Content-Type: application/json
Authorization: Bearer {{authToken}}

{
  "role": "admin",
  "isActiveResident": true
}

### Mitglied entfernen
DELETE {{baseUrl}}/groups/{{groupId}}/members/{{memberId}}
Authorization: Bearer {{authToken}}

### Gruppe löschen (nur Owner)
DELETE {{baseUrl}}/groups/{{groupId}}
Authorization: Bearer {{authToken}}
